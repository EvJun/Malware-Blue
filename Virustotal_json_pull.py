import os
import requests
import json


API_KEY = "Your API Key! :)"
JSON_DIR = "json_files"

def fetch_file_info(hash_value):
    url = f"https://www.virustotal.com/vtapi/v2/file/report"
    params = {'apikey': API_KEY, 'resource': hash_value}
    response = requests.get(url, params=params)

    if response.status_code == 200:
        return response.json()
    else:
        print(f"Failed to pull info on the hash: {hash_value}")
        return None

def save_json_response(hash_value, json_response):
    file_path = os.path.join(JSON_DIR, f"{hash_value}.json")
    with open(file_path, "w") as json_file:
        json.dump(json_response, json_file, indent=4)
    print(f"JSON response saved for hash: {hash_value}")

def main():
    if not os.path.exists(JSON_DIR):
        os.makedirs(JSON_DIR)
    with open("hash_list.txt", "r") as hash_file:
        hashes = hash_file.read().splitlines()
    for hash_value in hashes:
        json_response = fetch_file_info(hash_value) #file info for each hash
        if json_response:
            save_json_response(hash_value, json_response)

if __name__ == "__main__":
    main()
